---
layout: default
title: 首页
---
{% assign ui = site.data.ui %}
{% assign home_title = ui.home_title | default: "📂 文档目录" %}
{% assign home_subtitle = ui.home_subtitle | default: "左侧按 _posts 目录路径聚合，右侧按行展示。支持搜索与更新时间显示。" %}
{% assign search_placeholder = ui.search_placeholder | default: "搜索标题或标签…" %}
{% assign label_published = ui.label_published | default: "发布于" %}
{% assign label_updated = ui.label_updated | default: "更新于" %}
{% assign label_catalog = ui.label_catalog | default: "目录" %}
{% assign label_all = ui.label_all | default: "全部" %}
{% assign label_uncategorized = ui.label_uncategorized | default: "未分类" %}

<div class="home-hero">
  <h1>{{ home_title }}</h1>
  <p>{{ home_subtitle }}</p>
</div>

<div class="layout-2col">
  <aside class="sidebar">
    <div class="sidebar-head">{{ label_catalog }}</div>
    <ul class="cats">
      <li class="cat active" data-path="__all">{{ label_all }} <span class="count">{{ site.posts | size }}</span></li>
      {%- assign keys = "" | split: "" -%}
      {%- for p in site.posts -%}
        {%- assign key = p.categories | join: "/" -%}
        {%- assign keys = keys | push: key -%}
      {%- endfor -%}
      {%- assign paths = keys | uniq | sort -%}
      {%- for path in paths -%}
        {%- assign count = 0 -%}
        {%- for p in site.posts -%}{%- if p.categories | join: "/" == path -%}{%- assign count = count | plus: 1 -%}{%- endif -%}{%- endfor -%}
        <li class="cat" data-path="{{ path | downcase | escape }}">{{ path | default: label_uncategorized }} <span class="count">{{ count }}</span></li>
      {%- endfor -%}
    </ul>
  </aside>

  <main class="main">
    <div class="toolbar">
      <div class="home-search">
        <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M21 21l-4.3-4.3m1.8-5.2a7 7 0 11-14 0 7 7 0 0114 0z" fill="none" stroke="currentColor" stroke-width="2"/>
        </svg>
        <input id="q" type="search" placeholder="{{ search_placeholder }}" />
      </div>
    </div>

    <section id="post-list">
      {% assign posts = site.posts | sort: "date" | reverse %}
      {% for post in posts %}
        {% assign path = post.categories | join: "/" %}
        {% assign upd = post.last_modified_at | default: post.updated | default: post.date %}
        <div class="post-line" data-title="{{ post.title | downcase | escape }}" data-path="{{ path | downcase | escape }}">
          <a href="{{ post.url | relative_url }}" class="title">{{ post.title }}</a>
          <span class="meta">
            {% if path != "" %}<em class="cat-label">[{{ path }}]</em>{% endif %}
            {{ label_published }} {{ post.date | date: "%Y-%m-%d" }}
            {% if upd and upd != post.date %} · {{ label_updated }} {{ upd | date: "%Y-%m-%d" }}{% endif %}
          </span>
        </div>
      {% endfor %}
    </section>
  </main>
</div>

<script>
(function(){
  const q = document.getElementById('q');
  const lines = Array.from(document.querySelectorAll('#post-list .post-line'));
  const cats = Array.from(document.querySelectorAll('.sidebar .cat'));
  let activePath = "__all";
  function applyFilter(){
    const term = (q?.value || '').trim().toLowerCase();
    lines.forEach(li => {
      const inTitle = li.dataset.title.includes(term);
      const pathMatch = activePath === "__all" || (li.dataset.path === activePath);
      li.style.display = ((term ? inTitle : true) && pathMatch) ? '' : 'none';
    });
  }
  q && q.addEventListener('input', applyFilter);
  cats.forEach(c => c.addEventListener('click', () => {
    cats.forEach(x => x.classList.remove('active'));
    c.classList.add('active');
    activePath = c.dataset.path;
    applyFilter();
  }));
})();
</script>
