---
layout: default
title: 首页
---
{% assign df = site.data.ui.date_format | default: "%b %-d, %Y" %}

<div class="k-main-layout">
  <!-- 左侧标签筛选器 -->
  <aside class="k-sidebar">
    <div class="k-tag-filter">
      <h3 class="k-filter-title">标签筛选</h3>
      <div class="k-filter-controls">
        <button class="k-filter-btn active" data-tag="all">全部 ({{ site.posts.size }})</button>
        {% comment %} 收集所有标签并统计数量 {% endcomment %}
        {% assign all_tags = "" | split: "" %}
        {% for post in site.posts %}
          {% for tag in post.tags %}
            {% unless all_tags contains tag %}
              {% assign all_tags = all_tags | push: tag %}
            {% endunless %}
          {% endfor %}
        {% endfor %}
        {% assign all_tags = all_tags | sort %}
        {% for tag in all_tags %}
          {% assign tag_count = 0 %}
          {% for post in site.posts %}
            {% if post.tags contains tag %}
              {% assign tag_count = tag_count | plus: 1 %}
            {% endif %}
          {% endfor %}
          <button class="k-filter-btn" data-tag="{{ tag }}">{{ tag }} ({{ tag_count }})</button>
        {% endfor %}
      </div>
    </div>
  </aside>

  <!-- 右侧文章列表 -->
  <main class="k-content">
    <section class="k-list" id="posts-list">
  {% assign posts = site.posts | sort: "date" | reverse %}
  {% for post in posts %}
    <article class="k-row" data-tags="{{ post.tags | join: ',' }}">
      <div class="k-date">{{ post.date | date: df }}</div>
      <div class="k-maincol">
        <h2 class="k-title"><a href="{{ post.url | relative_url }}">{{ post.title }}</a></h2>
        <p class="k-excerpt">
          {%- if post.excerpt -%}
            {{ post.excerpt | strip_html | strip_newlines | truncate: 180 }}
          {%- else -%}
            {{ post.content | strip_html | strip_newlines | truncate: 180 }}
          {%- endif -%}
        </p>
        {% if post.tags.size > 0 %}
        <div class="k-tags">
          {% for tag in post.tags %}
            <span class="k-tag">{{ tag }}</span>
          {% endfor %}
        </div>
        {% endif %}
      </div>
    </article>
    {% endfor %}
    </section>
  </main>
</div>
